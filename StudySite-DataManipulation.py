
# # Manipulating study site data
# Converting coordinates to WGS84

import numpy as np
from pyproj import Proj, transform

# These coordinates are from the file "carcdensdist.xlsx" describing carcass density and distance for each subplot
originalcoords = np.asarray([
    [446034.45913800000,6654370.72555000000],[446036.13873500000,6654361.02489000000],[446037.65301600000,6654351.31762000000],[446039.29293700000,6654341.45164000000],
    [446041.24695500000,6654331.69147000000],[446023.36653000000,6654370.25275000000],[446023.75005900000,6654359.58665000000],[446024.05919800000,6654350.46790000000],
    [446024.58985800000,6654340.49613000000],[446025.49578200000,6654330.81200000000],[446013.19968200000,6654381.56358000000],[446013.35838400000,6654372.18363000000],
    [446013.47741100000,6654361.59357000000],[446013.95682300000,6654351.66478000000],[446014.39986600000,6654341.98396000000],[446014.86274700000,6654331.90638000000],
    [446003.33032100000,6654381.80417000000],[446004.35535200000,6654370.91732000000],[446005.25962300000,6654360.99348000000],[446005.91592200000,6654353.03524000000],
    [446006.33912700000,6654343.22051000000],[446006.72265700000,6654332.49655000000],[446007.13925000000,6654321.54942000000],[445993.46045900000,6654382.30167000000],
    [445993.77191200000,6654372.98540000000],[445994.17197300000,6654362.95081000000],[445993.43797700000,6654354.04862000000],[445995.30437800000,6654342.57744000000],
    [445996.00231700000,6654332.69712000000],[445983.61060900000,6654382.50248000000],[445984.10611700000,6654370.82308000000],[445984.42589200000,6654360.62562000000],
    [445984.16997000000,6654352.92237000000],[445984.15093400000,6654342.27958000000],[445983.85138400000,6654333.61739000000],[445974.85827000000,6654373.70287000000],
    [445974.47474000000,6654363.63190000000],[445973.89007200000,6654353.54140000000],[445973.38035800000,6654343.74456000000],[445973.68234800000,6654332.47837000000],
    [445964.94270100000,6654374.23849000000],[445962.68450400000,6654363.80052000000],[445962.55225200000,6654353.42869000000],[445962.37371200000,6654343.96608000000],
    [445962.03316400000,6654333.52481000000],[445962.04638900000,6654324.20768000000],[445953.18222100000,6654374.86007000000],[445953.50954400000,6654364.86846000000],
    [445953.40374300000,6654354.92644000000],[445953.42358000000,6654346.00606000000],[445943.39559800000,6654375.86518000000],[445942.87651000000,6654366.00251000000],
    [445942.40040400000,6654356.09025000000],[445941.70608200000,6654346.25073000000],[445941.04482400000,6654336.43104000000],[445934.36611500000,6654386.48499000000],
    [445933.40729000000,6654376.60248000000],[445932.86836500000,6654366.62079000000],[445932.40548400000,6654356.76143000000],[445933.78230700000,6654347.02475000000],
    [445924.55965300000,6654386.61394000000],[445924.37119500000,6654376.71820000000],[445924.07693500000,6654366.81586000000],[445923.73638700000,6654356.89368000000],
    [445914.28369900000,6654386.69659000000],[445913.70840400000,6654376.79756000000],[445912.61071500000,6654366.63071000000],[445904.66900200000,6654386.98424000000],
    [445903.39608000000,6654378.10023000000],[445902.13307600000,6654368.36982000000],[446023.85256500000,6654382.86688000000],[446037.22981100000,6654384.18877000000],
    [446048.06783500000,6654386.52963000000],[446057.94042300000,6654386.80074000000],[446067.40303000000,6654388.06374000000],[446018.35419100000,6654365.64378000000],
    [446018.79723400000,6654355.55298000000],[446019.10802600000,6654347.40628000000],[446020.15942700000,6654337.60643000000],[446008.04186700000,6654376.82401000000],
    [446008.77255800000,6654366.43233000000],[446008.90480900000,6654356.37294000000],[446009.23213200000,6654347.21286000000],[446008.99077300000,6654336.49717000000],
    [445998.65199900000,6654377.42410000000],[445999.32978900000,6654366.94646000000],[445998.94791200000,6654357.28382000000],[445999.64968300000,6654348.48141000000],
    [446001.12179900000,6654337.90399000000],[446002.45397600000,6654327.09813000000],[445988.86537500000,6654376.48015000000],[445989.45389500000,6654366.61418000000],
    [445988.72320500000,6654357.26398000000],[445990.92023500000,6654345.67213000000],[445991.34013400000,6654338.02467000000],[445993.32060300000,6654327.95371000000],
    [445978.93162100000,6654376.00405000000],[445979.42095300000,6654365.94631000000],[445978.89029300000,6654356.02578000000],[445981.42787200000,6654344.69346000000],
    [445981.57830900000,6654338.26357000000]
])


# Defining the coordinate systems recorded in, and desired for transformation
inProj = Proj(init='epsg:32632')
outProj = Proj(init='epsg:4326') # Sentinel-hub uses this coordinate system as a default

# Calculating the minimum bounding box over study area

def studyarea_boundswithbuffer(points):  #adding a 5km buffer area to minimum bounding rectangle
    x_coordinates, y_coordinates = zip(*points)
    return [(min(x_coordinates)+5000, min(y_coordinates)+5000), (max(x_coordinates)+5000, max(y_coordinates)+5000)]

studyarea = studyarea_boundswithbuffer(originalcoords)

# Transforming the study area bounding box to WGS84

SAB_transformed = [transform(inProj,outProj, studyarea[0][0], studyarea[0][1]),
                   transform(inProj,outProj, studyarea[1][0], studyarea[1][1])]
print(SAB_transformed)
